{
  "run_name": "chf_rectangular_staged_bdann_pure",
  "seed": 1234,
  "logging": {
    "save_summaries": true,
    "save_plots": true,
    "verbose": 2
  },
  "data": {
    "mode": "files",
    "source": {
      "train_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_tube_common_bibosk_train.csv",
      "valid_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_tube_common_bibosk_valid.csv",
      "test_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_tube_common_bibosk_test.csv",
      "features": ["Hydraulic Diameter", "Heated Length", "Pressure", "Mass Flux", "Inlet Subcooling"],
      "outputs": "CHF"
    },
    "target": {
      "train_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_rect_all_bibosk_train.csv",
      "valid_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_rect_all_bibosk_valid.csv",
      "test_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_rect_all_bibosk_test.csv",
      "features": ["Hydraulic Diameter", "Heated Length", "Pressure", "Mass Flux", "Inlet Subcooling"],
      "outputs": "CHF"
    },
    "scaling": {
      "standardize_X": true,
      "standardize_y": true
    },
    "noise_injection": {
      "enabled": false,
      "source_factor": 0.0001,
      "target_factor": 0.005
    }
  },
  "stage1": {
    "mode": "load",
    "extractor_weights": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/base_models/base_model_pure/feature_extractor.h5",
    "reg_head_weights": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/base_models/base_model_pure/reg_head.h5",
    "architecture": {
      "feature_extractor": {
        "layers": [10, 18, 26, 26, 17],
        "activations": ["relu", "relu", "relu", "relu", "relu"]
      },
      "reg_head": {
        "out_units": 1,
        "activation": null
      }
    }
  },
  "stage2": {
    "enabled": true,
    "epochs": 20,
    "batch_size": 16,
    "warmup_epochs": 14,
    "optimizer": {
      "lr": 9.950896430135321e-05,
      "decay_every_epochs": 5,
      "decay_rate": 0.96
    },
    "lambda_max": 1.5125112916940588,
    "lambda_min_frac": 0.1010268011556005,
    "ramp_k": 9.961257626200334,
    "domain_head": {
      "dropout": 0.47765778364602113,
      "widths": [160, 96, 96, 96],
      "l2": 1.3129143718648006e-06
    }
  },
  "stage3": {
    "fully_deterministic": false,
    "epochs": 400,
    "batch_size": 16,
    "optimizer": {
      "lr": 0.004527246066705649,
      "decay_every_epochs": 10,
      "decay_rate": 0.96
    },
    "kl_weight_max": 0.003151649474094204,
    "freeze": {
      "unfreeze_from_layer_idx": -6
    },
    "bayesian_policy": {
      "by_index": [-5, -4, -3, -2, -1],
      "must_be_downstream": true
    },
    "architecture": {
      "feature_extractor": {
        "layers": [10, 18, 26, 26, 17],
        "activations": ["relu", "relu", "relu", "relu", "relu"]
      },
      "reg_head": {
        "out_units": 2,
        "activation": null
      }
    }
  },
  "seed_ensemble": {
    "enabled": false,
    "n": 20,
    "base_seed": 1234,
    "step": 1
  },
  "metrics": {
    "ape_epsilon": 1e-08,
    "mc_samples_test": 200
  },
  "outfiles": {
    "save_hdf5_model": true,
    "save_metadata_h5": true
  }
}