{
  "run_name": "chf_rectangular_staged_bdann_pure",
  "seed": 1234,
  "logging": {
    "save_summaries": true,
    "save_plots": true,
    "verbose": 2
  },
  "data": {
    "mode": "files",
    "source": {
      "train_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_tube_common_bibosk_train.csv",
      "valid_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_tube_common_bibosk_valid.csv",
      "test_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_tube_common_bibosk_test.csv",
      "features": [
        "Hydraulic Diameter",
        "Heated Length",
        "Pressure",
        "Mass Flux",
        "Inlet Subcooling"
      ],
      "outputs": [
        "CHF"
      ],
      "single_csv": null
    },
    "target": {
      "train_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_rect_all_bibosk_train.csv",
      "valid_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_rect_all_bibosk_valid.csv",
      "test_csv": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/data/chf_rect_all_bibosk_test.csv",
      "features": [
        "Hydraulic Diameter",
        "Heated Length",
        "Pressure",
        "Mass Flux",
        "Inlet Subcooling"
      ],
      "outputs": [
        "CHF"
      ],
      "single_csv": null
    },
    "scaling": {
      "standardize_X": true,
      "standardize_y": true
    },
    "noise_injection": {
      "enabled": false,
      "source_factor": 0.0001,
      "target_factor": 0.005
    },
    "splits": {
      "source": [
        0.8,
        0.1,
        0.1
      ],
      "target": [
        0.25,
        0.5,
        0.25
      ]
    }
  },
  "stage1": {
    "mode": "load",
    "extractor_weights": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/base_models/base_model_pure/feature_extractor.h5",
    "reg_head_weights": "/Users/aidanfurlong/Documents/Python_Scripts/ORNL 24/dann_alternate_geometries/rectangular_v2/base_models/base_model_pure/reg_head.h5",
    "architecture": {
      "feature_extractor": {
        "layers": [
          10,
          18,
          26,
          26,
          17
        ],
        "activations": [
          "relu",
          "relu",
          "relu",
          "relu",
          "relu"
        ]
      },
      "reg_head": {
        "out_units": 1,
        "activation": null
      }
    },
    "optimizer": {
      "lr": 0.001,
      "decay_every_epochs": 10,
      "decay_rate": 0.96
    },
    "epochs": 150,
    "batch_size": 16,
    "early_stopping": {
      "enabled": true,
      "patience": 50,
      "min_delta": 0.0,
      "monitor": "val_loss",
      "mode": "min",
      "restore_best_weights": true
    }
  },
  "stage2": {
    "enabled": true,
    "epochs": 20,
    "batch_size": 16,
    "warmup_epochs": 14,
    "optimizer": {
      "lr": 9.950896430135321e-05,
      "decay_every_epochs": 5,
      "decay_rate": 0.96
    },
    "lambda_max": 1.5125112916940588,
    "lambda_min_frac": 0.1010268011556005,
    "ramp_k": 9.961257626200334,
    "domain_head": {
      "dropout": 0.47765778364602113,
      "widths": [
        160,
        96,
        96,
        96
      ],
      "l2": 1.3129143718648006e-06
    },
    "early_stopping": {
      "enabled": false,
      "monitor": "dann_alignment",
      "patience": 10,
      "min_delta": 0.001,
      "min_epochs": 10,
      "gamma": 0.5,
      "restore_best_weights": true
    }
  },
  "stage3": {
    "fully_deterministic": false,
    "epochs": 400,
    "batch_size": 16,
    "optimizer": {
      "lr": 0.004527246066705649,
      "decay_every_epochs": 10,
      "decay_rate": 0.96
    },
    "kl_weight_max": 0.003151649474094204,
    "freeze": {
      "unfreeze_from_layer_idx": -6
    },
    "early_stopping": {
      "enabled": false,
      "patience": 50,
      "min_delta": 0.0,
      "monitor": "val_loss",
      "mode": "min",
      "restore_best_weights": true
    },
    "bayesian_policy": {
      "by_index": [
        -5,
        -4,
        -3,
        -2,
        -1
      ],
      "must_be_downstream": true,
      "min_bayesian_layers_for_uq": 2
    },
    "architecture": {
      "feature_extractor": {
        "layers": [
          10,
          18,
          26,
          26,
          17
        ],
        "activations": [
          "relu",
          "relu",
          "relu",
          "relu",
          "relu"
        ]
      },
      "reg_head": {
        "out_units": 2,
        "activation": null
      }
    }
  },
  "seed_ensemble": {
    "enabled": true,
    "n": 20,
    "base_seed": 1234,
    "step": 1
  },
  "metrics": {
    "ape_epsilon": 1e-08,
    "mc_samples_test": 200
  },
  "outfiles": {
    "save_hdf5_model": true,
    "save_metadata_h5": true
  }
}